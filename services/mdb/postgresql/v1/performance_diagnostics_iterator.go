// Code generated by sdkgen-v2. DO NOT EDIT.
package postgresqlsdk

import (
	"context"

	postgresql "github.com/yandex-cloud/go-genproto/yandex/cloud/mdb/postgresql/v1"
	"github.com/yandex-cloud/go-sdk/v2/pkg/iterator"
	"google.golang.org/grpc"
)

type PerformanceDiagnosticsClientIterator interface {
	RawSessionStatesIterator(context.Context, *postgresql.ListRawSessionStatesRequest, ...grpc.CallOption) *iterator.Iterator[*postgresql.ListRawSessionStatesRequest, *postgresql.SessionState]
	RawStatementsIterator(context.Context, *postgresql.ListRawStatementsRequest, ...grpc.CallOption) *iterator.Iterator[*postgresql.ListRawStatementsRequest, *postgresql.QueryStatement]
}

type performanceDiagnosticsServiceListRawSessionStatesInternal struct {
	*postgresql.ListRawSessionStatesResponse
}

func (r performanceDiagnosticsServiceListRawSessionStatesInternal) Items() []*postgresql.SessionState {
	return r.ListRawSessionStatesResponse.SessionStates
}

func (c performanceDiagnosticsClient) RawSessionStatesIterator(ctx context.Context, req *postgresql.ListRawSessionStatesRequest, opts ...grpc.CallOption) *iterator.Iterator[*postgresql.ListRawSessionStatesRequest, *postgresql.SessionState] {
	return iterator.NewIterator[*postgresql.ListRawSessionStatesRequest, *postgresql.SessionState](ctx, req,
		func(ctx context.Context, req *postgresql.ListRawSessionStatesRequest, opts ...grpc.CallOption) (iterator.PageResponse[*postgresql.SessionState], error) {
			resp, err := c.ListRawSessionStates(ctx, req, opts...)
			if err != nil {
				return nil, err
			}
			return performanceDiagnosticsServiceListRawSessionStatesInternal{resp}, nil
		})
}

type performanceDiagnosticsServiceListRawStatementsInternal struct {
	*postgresql.ListRawStatementsResponse
}

func (r performanceDiagnosticsServiceListRawStatementsInternal) Items() []*postgresql.QueryStatement {
	return r.ListRawStatementsResponse.Statements
}

func (c performanceDiagnosticsClient) RawStatementsIterator(ctx context.Context, req *postgresql.ListRawStatementsRequest, opts ...grpc.CallOption) *iterator.Iterator[*postgresql.ListRawStatementsRequest, *postgresql.QueryStatement] {
	return iterator.NewIterator[*postgresql.ListRawStatementsRequest, *postgresql.QueryStatement](ctx, req,
		func(ctx context.Context, req *postgresql.ListRawStatementsRequest, opts ...grpc.CallOption) (iterator.PageResponse[*postgresql.QueryStatement], error) {
			resp, err := c.ListRawStatements(ctx, req, opts...)
			if err != nil {
				return nil, err
			}
			return performanceDiagnosticsServiceListRawStatementsInternal{resp}, nil
		})
}
