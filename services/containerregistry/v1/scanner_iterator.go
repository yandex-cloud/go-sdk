// Code generated by sdkgen-v2. DO NOT EDIT.
package containerregistrysdk

import (
	"context"

	containerregistry "github.com/yandex-cloud/go-genproto/yandex/cloud/containerregistry/v1"
	"github.com/yandex-cloud/go-sdk/v2/pkg/iterator"
	"google.golang.org/grpc"
)

type ScannerClientIterator interface {
	Iterator(context.Context, *containerregistry.ListScanResultsRequest, ...grpc.CallOption) *iterator.Iterator[*containerregistry.ListScanResultsRequest, *containerregistry.ScanResult]
	VulnerabilitiesIterator(context.Context, *containerregistry.ListVulnerabilitiesRequest, ...grpc.CallOption) *iterator.Iterator[*containerregistry.ListVulnerabilitiesRequest, *containerregistry.Vulnerability]
}

type scannerServiceListInternal struct {
	*containerregistry.ListScanResultsResponse
}

func (r scannerServiceListInternal) Items() []*containerregistry.ScanResult {
	return r.ListScanResultsResponse.ScanResults
}

func (c scannerClient) Iterator(ctx context.Context, req *containerregistry.ListScanResultsRequest, opts ...grpc.CallOption) *iterator.Iterator[*containerregistry.ListScanResultsRequest, *containerregistry.ScanResult] {
	return iterator.NewIterator[*containerregistry.ListScanResultsRequest, *containerregistry.ScanResult](ctx, req,
		func(ctx context.Context, req *containerregistry.ListScanResultsRequest, opts ...grpc.CallOption) (iterator.PageResponse[*containerregistry.ScanResult], error) {
			resp, err := c.List(ctx, req, opts...)
			if err != nil {
				return nil, err
			}
			return scannerServiceListInternal{resp}, nil
		})
}

type scannerServiceListVulnerabilitiesInternal struct {
	*containerregistry.ListVulnerabilitiesResponse
}

func (r scannerServiceListVulnerabilitiesInternal) Items() []*containerregistry.Vulnerability {
	return r.ListVulnerabilitiesResponse.Vulnerabilities
}

func (c scannerClient) VulnerabilitiesIterator(ctx context.Context, req *containerregistry.ListVulnerabilitiesRequest, opts ...grpc.CallOption) *iterator.Iterator[*containerregistry.ListVulnerabilitiesRequest, *containerregistry.Vulnerability] {
	return iterator.NewIterator[*containerregistry.ListVulnerabilitiesRequest, *containerregistry.Vulnerability](ctx, req,
		func(ctx context.Context, req *containerregistry.ListVulnerabilitiesRequest, opts ...grpc.CallOption) (iterator.PageResponse[*containerregistry.Vulnerability], error) {
			resp, err := c.ListVulnerabilities(ctx, req, opts...)
			if err != nil {
				return nil, err
			}
			return scannerServiceListVulnerabilitiesInternal{resp}, nil
		})
}
